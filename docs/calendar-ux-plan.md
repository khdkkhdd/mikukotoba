# 캘린더 기반 UX 개선 기획

## 개요

앱 전반에 캘린더 UI를 도입하여 날짜 기반 탐색/필터링/통계 기능을 강화한다.
4개 영역에 걸친 개선: 단어 목록, 학습 모드 네비게이션, 자유 복습, 학습 통계.

---

## 1. 단어 목록 UI/UX 개선

### 현재 상태

- 단어 탭에서 전체 목록을 flat하게 보여줌
- 날짜별 그룹핑 쿼리(`getDateGroups`)는 존재하나 미사용
- 필터링/검색 기능 없음

### 개선안

#### 1-1. 캘린더 필터 모드

단어 탭 상단에 **접이식 캘린더**를 배치한다.

```
┌──────────────────────────────────┐
│  ◀  2026년 2월  ▶               │
│  일  월  화  수  목  금  토      │
│                          1       │
│   2   3   4   5   6   7   8     │
│   9  10  11  12  13  [14] 15    │
│  16  17  18  19  20  21  22     │
│  23  24  25  26  27  28         │
│                                  │
│  ● = 단어가 있는 날짜 (점 표시)  │
└──────────────────────────────────┘
┌──────────────────────────────────┐
│  2월 14일 · 5개 단어             │
│  ─────────────────────────────── │
│  日本語  にほんご  일본어         │
│  勉強    べんきょう  공부         │
│  ...                             │
└──────────────────────────────────┘
```

- **캘린더 마킹**: 단어가 추가된 날짜에 점(dot) 표시. 개수에 따라 1개/2개/3개 점 또는 색상 농도 변화.
- **날짜 탭**: 특정 날짜를 탭하면 해당 날짜에 추가된 단어만 필터링하여 표시.
- **접기/펼치기**: 캘린더를 접으면 주간 뷰로 축소. 스크롤 시 자동 접힘.

#### 1-2. 보기 모드 전환

캘린더 아래에 보기 모드 토글:

| 모드 | 설명 |
|------|------|
| **전체** | 모든 단어를 최신순으로 표시 (현재와 동일) |
| **날짜별** | 캘린더에서 선택한 날짜의 단어만 표시 |

- 기본값은 "전체"
- 캘린더에서 날짜를 탭하면 자동으로 "날짜별" 모드로 전환
- "전체" 버튼을 누르면 날짜 선택 해제 + 전체 목록 복귀

#### 1-3. 날짜 그룹 헤더

전체 모드에서도 날짜별 구분선(section header)을 표시:

```
── 2월 14일 (금) · 5개 ──
  日本語  にほんご  일본어
  勉強    べんきょう  공부
── 2월 13일 (목) · 3개 ──
  先生    せんせい  선생님
  ...
```

---

## 2. 학습 모드 네비게이션 개선

### 현재 상태

- SrsSession: "학습 종료" 버튼이 대기 화면과 완료 화면에만 존재
- RelaySession: "종료" 버튼이 하단에 존재
- 학습 중 카드를 보고 있는 상태에서는 나가는 방법이 없음
- 모드 간 전환 불가

### 개선안

#### 2-1. 공통 학습 헤더

모든 학습 세션에 상단 헤더 바를 추가:

```
┌──────────────────────────────────┐
│  ✕ 종료     오늘의 학습    ⋯    │
│                                  │
│  [ 카드 UI ]                     │
│                                  │
└──────────────────────────────────┘
```

- **✕ 종료**: 왼쪽 상단. 탭하면 확인 다이얼로그 표시.
- **모드 이름**: 중앙에 현재 모드명 ("오늘의 학습" / "자유 복습")
- 항상 노출 — 카드 학습 중에도 접근 가능

#### 2-2. 종료 확인

학습 중 "✕ 종료"를 누르면:

```
┌─────────────────────────┐
│  학습을 중단할까요?      │
│                          │
│  진행한 내용은 저장됩니다.│
│                          │
│  [계속 학습]  [중단하기]  │
└─────────────────────────┘
```

- SrsSession: 이미 grade를 준 카드들은 저장된 상태이므로, 중단해도 진행분 유지
- RelaySession: 별도 저장 없으므로 즉시 종료

#### 2-3. 완료 화면에서 모드 전환

SrsSession 완료 화면에 모드 전환 옵션 추가:

```
┌──────────────────────────────────┐
│           🎉                     │
│       학습 완료!                  │
│                                  │
│  12개 복습 / 10개 정답 (83%)     │
│                                  │
│  [돌아가기]   [자유 복습 시작 →]  │
└──────────────────────────────────┘
```

- SRS 학습 완료 후 자연스럽게 자유 복습으로 이어갈 수 있는 동선

---

## 3. 자유 복습 캘린더 개선

### 현재 상태

- 시작일/종료일을 ◀/▶ 버튼으로 월 단위 이동하여 선택
- 정확한 날짜 지정이 번거로움
- 어떤 날짜에 단어가 있는지 알 수 없음

### 개선안

#### 3-1. 캘린더 범위 선택

◀/▶ 방식 대신 시각적 캘린더로 교체:

```
┌──────────────────────────────────┐
│  자유 복습                       │
│                                  │
│  ◀  2026년 2월  ▶               │
│  일  월  화  수  목  금  토      │
│                          1       │
│   2   3  [4 ██████████ 14] 15   │
│  16  17  18  19  20  21  22     │
│  23  24  25  26  27  28         │
│                                  │
│  ● = 단어가 있는 날짜            │
│  ██ = 선택 범위 (시작~끝)        │
│                                  │
│  2/4 ~ 2/14 · 28개 단어          │
│                                  │
│  [전체 선택]    [시작하기]        │
└──────────────────────────────────┘
```

- **범위 선택 UX**: 첫 탭 = 시작일, 두 번째 탭 = 종료일. 사이 구간 하이라이트.
- **단어 마킹**: 단어가 있는 날짜에 점 표시 → 빈 날짜를 피해서 범위 설정 가능
- **단어 개수**: 선택 범위 내 총 단어 수 실시간 표시 (기존 기능 유지)
- **전체 선택**: 전체 날짜 범위로 리셋
- **빠른 선택 칩**: 캘린더 아래에 "최근 7일", "최근 30일", "이번 달" 같은 프리셋 버튼

#### 3-2. 빠른 선택 프리셋

캘린더 아래에 자주 쓰는 범위를 빠르게 선택하는 칩:

```
[최근 7일]  [최근 30일]  [이번 달]  [전체]
```

탭하면 캘린더의 범위가 자동 설정되고, 단어 개수가 업데이트됨.

---

## 4. 학습 통계 페이지

### 현재 상태

- 학습 통계 없음 (세션 완료 시 "N개 복습 / M개 정답"만 표시)
- review_log 테이블에 모든 학습 기록이 저장되어 있음 (vocab_id, rating, reviewed_at)
- getTodayReviewCount 쿼리 존재하나 미사용

### 개선안

#### 4-1. 통계 탭 추가

기존 4탭에서 "통계" 탭을 추가하거나, 학습 탭 내에 통계 섹션을 배치.

**추천: 학습 탭 내 통계 접근** — 모드 선택 화면에 통계 카드를 추가하여 진입.

```
┌──────────────────────────────────┐
│  학습                            │
│                                  │
│  ┌────────────┐ ┌────────────┐  │
│  │ 🎓         │ │ 🔀         │  │
│  │ 오늘의 학습│ │ 자유 복습  │  │
│  │ 복습 5 +   │ │ 전체 120개 │  │
│  │ 새단어 3   │ │            │  │
│  └────────────┘ └────────────┘  │
│                                  │
│  ┌─────────────────────────────┐ │
│  │ 📊 학습 통계                │ │
│  │ 오늘 15개 학습 · 3일 연속    │ │
│  └─────────────────────────────┘ │
└──────────────────────────────────┘
```

#### 4-2. 통계 메인 화면

```
┌──────────────────────────────────┐
│  ← 학습 통계                     │
│                                  │
│  ── 요약 ──                      │
│  🔥 연속 학습: 7일               │
│  📚 총 학습 카드: 342개          │
│  ✅ 평균 정확도: 81%             │
│                                  │
│  ── 2026년 2월 ──                │
│  ◀  캘린더 히트맵  ▶            │
│  일  월  화  수  목  금  토      │
│       □  ■  ■  □  ■  □          │
│  □  ■  ■  ■  □  ■  □           │
│  ■  ■  □  ■  ■  ■  ■           │
│  □  ■  ■  ·  ·  ·  ·           │
│                                  │
│  □ 미학습  ■ 학습 (색 농도=양)   │
│                                  │
│  ── 기간별 통계 ──               │
│  [오늘]  [이번 주]  [이번 달]     │
│                                  │
└──────────────────────────────────┘
```

#### 4-3. 캘린더 히트맵

- **색상 농도**: 학습량에 비례 (0개=빈칸, 1~5개=연한색, 6~15개=중간, 16개+=진한색)
- **날짜 탭**: 특정 날짜를 탭하면 해당 날짜의 상세 통계 표시
- **월 이동**: ◀/▶로 이전/다음 달 조회

#### 4-4. 날짜 상세 통계

캘린더에서 날짜를 탭하면 하단에 해당 날짜의 상세 정보 표시:

```
┌──────────────────────────────────┐
│  2월 14일 (금)                   │
│                                  │
│  학습한 카드     15개            │
│  새로 배운 단어   3개            │
│  복습한 단어     12개            │
│  정답률          80% (12/15)     │
│                                  │
│  등급 분포                       │
│  Again ██░░░░░░░░  2개 (13%)    │
│  Hard  ███░░░░░░░  1개 (7%)     │
│  Good  ████████░░  9개 (60%)    │
│  Easy  ███░░░░░░░  3개 (20%)    │
└──────────────────────────────────┘
```

#### 4-5. 기간별 요약 통계

"오늘 / 이번 주 / 이번 달" 탭으로 기간별 집계:

```
┌──────────────────────────────────┐
│  이번 주 (2/10 ~ 2/16)          │
│                                  │
│  총 학습 카드     67개           │
│  일 평균          9.6개          │
│  새 단어          12개           │
│  정답률           78%            │
│  학습한 날        5/7일          │
│                                  │
│  일별 추이                       │
│    15 │       ■                  │
│    10 │ ■  ■  ■  ■              │
│     5 │ ■  ■  ■  ■  ■          │
│     0 │────────────────          │
│       월 화 수 목 금 토 일       │
└──────────────────────────────────┘
```

#### 4-6. 전체 통계

화면 상단 요약 영역에 전체 기간 통계:

| 지표 | 설명 |
|------|------|
| 연속 학습일 | 오늘 포함 연속으로 학습한 날 수 (스트릭) |
| 최장 연속 기록 | 역대 최장 스트릭 |
| 총 학습 카드 | 전체 review_log 건수 |
| 총 학습일 | review_log가 있는 고유 날짜 수 |
| 전체 정답률 | Good+Easy 비율 |
| 총 단어 수 | 등록된 전체 단어 |
| 마스터한 단어 | Review 상태 + stability 높은 카드 수 |

---

## 공통: 캘린더 컴포넌트

### 요구사항

3곳(단어 목록, 자유 복습, 통계)에서 캘린더를 사용하므로, 공통 컴포넌트로 구현.

| 기능 | 단어 목록 | 자유 복습 | 통계 |
|------|----------|----------|------|
| 단일 날짜 선택 | ✅ | | ✅ |
| 범위 선택 | | ✅ | |
| 날짜 마킹 (dot) | ✅ 단어 존재 | ✅ 단어 존재 | |
| 히트맵 (색상 농도) | | | ✅ 학습량 |
| 접기/펼치기 | ✅ | | |
| 월 이동 | ✅ | ✅ | ✅ |

### 라이브러리 선택지

- **react-native-calendars**: 가장 인기 있는 RN 캘린더. 마킹(dot, period, multi-dot), 범위 선택, 커스텀 스타일 모두 지원.
- **직접 구현**: 요구사항이 단순하다면 커스텀으로도 가능. 히트맵은 커스텀 렌더링 필요할 수 있음.

---

## 구현 우선순위 제안

| 순서 | 항목 | 이유 |
|------|------|------|
| 1 | **학습 모드 네비게이션** (#2) | 가장 작은 변경, 즉시 UX 개선. 캘린더 의존 없음 |
| 2 | **캘린더 공통 컴포넌트** | 이후 3개 기능의 기반 |
| 3 | **자유 복습 캘린더** (#3) | 기존 기능 교체, 범위 선택 UX 크게 개선 |
| 4 | **단어 목록 개선** (#1) | 캘린더 필터 + 날짜 그룹 헤더 |
| 5 | **학습 통계** (#4) | 가장 큰 신규 기능, DB 쿼리 추가 필요 |
