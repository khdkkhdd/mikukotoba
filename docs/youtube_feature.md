# YouTube 번역 기능 명세서

> ミク言葉 - YouTube 사이트에 특화된 번역 기능의 사용자 관점 기능 명세
> 작성일: 2026-02-19

---

## 1. 기능 개요

YouTube에서 일본어 콘텐츠를 시청할 때, **비디오 자막**과 **페이지 텍스트**(제목, 댓글, 설명 등)를 한국어로 번역하여 학습을 돕는 기능.

**핵심 가치**: "자막을 읽고 → 후리가나로 읽기를 익히고 → 번역으로 이해한다"의 학습 사이클을 YouTube 시청 흐름에 자연스럽게 통합

**이 문서의 범위**: YouTube에 특화된 자막 인터셉트, 오버레이 표시, 페이지 요소 번역을 다룬다. 번역 엔진 선택, 호버/인라인/후리가나 표시 방식, 설정 페이지 등 모든 사이트에서 공통인 기능은 `translation_feature.md`를 참고한다.

---

## 2. 자막 번역

### 2.1 자동 시작

YouTube 시청 페이지(`/watch`)에 진입하면, 확장 프로그램이 자동으로:

1. 해당 영상에 일본어 자막이 있는지 확인한다.
2. 자막이 있으면 YouTube 기본 자막을 숨기고, ミク言葉 오버레이로 대체한다.
3. 자막이 없으면 아무 동작도 하지 않는다.

사용자가 자막을 이미 켜놓은 경우에도, 아직 켜지 않은 경우에도 모두 대응한다. 확장 프로그램이 자동으로 자막을 활성화하려고 시도한다.

### 2.2 자막 종류

| 자막 유형 | 설명 |
|----------|------|
| **수동 자막** | 업로더가 직접 입력한 자막. 정확도가 높다. |
| **자동 생성 자막 (ASR)** | YouTube가 음성 인식으로 자동 생성한 자막. 정확도가 다소 낮을 수 있다. |

수동 자막이 있으면 수동 자막을 우선 사용하고, 없으면 자동 생성 자막을 사용한다.

### 2.3 오버레이 표시

비디오 플레이어 하단에 번역 오버레이가 나타난다. YouTube 기본 자막과 동일한 위치(컨트롤 바 바로 위)에 중앙 정렬로 표시된다.

#### 표시 구조 (위에서 아래로)

| 줄 | 내용 | 조건 |
|----|------|------|
| **1줄** | 일본어 원문 + 후리가나 | 후리가나 ON일 때 한자 위에 히라가나 표시 |
| **2줄** | 로마자 | 로마자 ON일 때 |
| **3줄** | 한국어 번역 | 번역 ON일 때 |
| **우하단** | 엔진 배지 | 항상 (예: `papago`, `claude cache`) |

- 각 줄은 설정에 따라 개별적으로 표시/숨김 가능하다.
- 후리가나가 OFF이면 원문만 표시되고, 한자 위에 읽기가 붙지 않는다.
- 오버레이 배경은 반투명 검정이며, 투명도를 설정에서 조절할 수 있다.
- 자막이 바뀔 때 부드럽게 페이드인/아웃된다.

#### 색상 커스터마이제이션

설정 페이지에서 오버레이의 각 요소 색상을 변경할 수 있다:

| 요소 | 기본 색상 |
|------|----------|
| 원문 | 흰색 |
| 후리가나 | 회색 |
| 로마자 | 하늘색 |
| 번역 | 연한 노랑 |

글꼴 크기(14~32px)와 배경 투명도(0~100%)도 조절 가능하며, 변경 시 설정 페이지의 미리보기에서 결과를 바로 확인할 수 있다.

### 2.4 단어 클릭

오버레이에 표시된 일본어 원문의 개별 단어를 클릭할 수 있다.

- 마우스를 올리면 단어에 미세한 배경 하이라이트가 나타난다.
- 클릭하면 해당 단어의 상세 정보가 팝업으로 표시된다:

| 항목 | 설명 | 예시 |
|------|------|------|
| **표기** | 원래 표기 | `食べる` |
| **읽기** | 히라가나 | `たべる` |
| **로마자** | 알파벳 | `taberu` |
| **기본형** | 사전형 | `食べる` |
| **품사** | 일본어 품사 | `動詞` |

- 팝업은 클릭한 단어 위에 나타나며, 다른 곳을 클릭하면 닫힌다.

### 2.5 자막 동기화

자막은 비디오 재생 시간과 동기화되어 표시된다.

- 현재 시점에 해당하는 자막만 표시된다.
- 자막이 끝나면 오버레이가 페이드아웃된다.
- 비디오를 탐색(시크)하면 해당 시점의 자막으로 즉시 전환된다.

### 2.6 선행 번역 (프리페치)

현재 자막이 표시되는 동안, 다음에 나올 자막 3개를 미리 번역해둔다. 이를 통해 자막이 전환될 때 번역 결과가 즉시 표시되어, 대기 시간 없이 시청을 이어갈 수 있다.

### 2.7 비디오 전환

YouTube의 SPA(Single Page Application) 특성상, 추천 영상 클릭 등으로 영상이 전환되어도 페이지가 새로 로드되지 않는다. ミク言葉는 이를 감지하여:

1. 이전 영상의 자막 상태를 정리한다.
2. 새 영상의 메타데이터(제목, 채널명)를 파악한다.
3. 새 영상의 자막 추출과 오버레이를 다시 시작한다.

번역 컨텍스트도 초기화되어, AI 번역 시 새 영상의 맥락이 반영된다.

### 2.8 자막 번역 ON/OFF

팝업의 **YouTube 자막 번역** 토글로 자막 번역을 독립적으로 켜고 끌 수 있다.

- OFF로 전환하면 오버레이가 사라지고 YouTube 기본 자막이 복원된다.
- ON으로 전환하면 다시 ミク言葉 오버레이가 나타난다.
- 페이지 텍스트 번역과는 별도로 동작한다 (자막만 끄고 페이지 번역은 유지 가능, 또는 그 반대).

---

## 3. 페이지 텍스트 번역

YouTube 페이지 내의 일본어 텍스트를 번역한다. 웹페이지 모드(호버/인라인/후리가나 전용/OFF) 설정을 따른다.

### 3.1 번역 대상

#### 시청 페이지 (`/watch`)

| 요소 | 번역 시점 |
|------|----------|
| **영상 제목** | 페이지 로드 즉시 |
| **채널명** | 페이지 로드 즉시 |
| **해시태그** | 페이지 로드 즉시 |
| **영상 설명** | "더보기" 클릭으로 펼쳤을 때 |
| **댓글** | 스크롤하여 댓글 영역이 화면에 보일 때 |
| **답글** | 답글을 펼쳤을 때 |
| **추천 영상 제목** (우측 사이드바) | 스크롤하여 해당 항목이 화면에 보일 때 |
| **챕터 제목** | 스크롤하여 해당 항목이 화면에 보일 때 |

#### 홈 / 구독 / 인기 피드

| 요소 | 번역 시점 |
|------|----------|
| **영상 제목** | 스크롤하여 화면에 보일 때 |
| **채널명** | 스크롤하여 화면에 보일 때 |
| **Shorts 제목** | 스크롤하여 화면에 보일 때 |

#### 검색 결과

| 요소 | 번역 시점 |
|------|----------|
| **영상 제목** | 스크롤하여 화면에 보일 때 |
| **설명 미리보기** | 스크롤하여 화면에 보일 때 |
| **채널 설명** | 스크롤하여 화면에 보일 때 |
| **재생목록 제목** | 스크롤하여 화면에 보일 때 |

#### 채널 페이지

| 요소 | 번역 시점 |
|------|----------|
| **채널명 (헤더)** | 페이지 로드 즉시 |
| **채널 태그라인** | 페이지 로드 즉시 |
| **채널 소개 (About)** | 스크롤하여 화면에 보일 때 |
| **커뮤니티 게시글** | 스크롤하여 화면에 보일 때 |
| **투표 선택지** | 스크롤하여 화면에 보일 때 |
| **재생목록 제목** | 스크롤하여 화면에 보일 때 |

#### 재생목록 페이지

| 요소 | 번역 시점 |
|------|----------|
| **재생목록 제목** | 페이지 로드 즉시 |
| **재생목록 설명** | 스크롤하여 화면에 보일 때 |
| **포함된 영상 제목** | 스크롤하여 화면에 보일 때 |

#### Shorts

| 요소 | 번역 시점 |
|------|----------|
| **Shorts 설명** | 화면에 보일 때 |
| **Shorts 채널명** | 화면에 보일 때 |
| **Shorts 댓글** | 화면에 보일 때 |

### 3.2 번역 제외 대상

다음은 번역하지 않는다:

- **YouTube UI 텍스트**: "홈", "급상승", "등록채널", "높이 평가", "공유", "저장" 등 YouTube 자체 인터페이스
- **메타데이터**: 조회수, 게시일, 구독자 수 등 숫자 정보
- **광고**: 광고 슬롯 내의 텍스트
- **URL, 타임스탬프**: 링크 주소나 `0:00` 형식의 시간
- **입력 필드**: 댓글 입력창 등 편집 가능한 영역

### 3.3 요소 유형별 표시 방식

페이지 텍스트는 성격에 따라 3가지 유형으로 구분되며, 각 유형별로 표시 방식이 다르다.

#### 주요 텍스트 (영상 제목, 검색 결과 제목 등)

**인라인 모드**:
- 원문을 후리가나가 붙은 버전으로 대체한다.
- 그 아래에 번역 블록이 삽입된다 (로마자 + 한국어 번역 + 엔진 배지).
- 한국어 번역은 **블러(스포일러) 처리**되어 숨겨지며, 클릭하면 보인다 → "먼저 스스로 해석해보기" 학습 흐름.

**후리가나 전용 모드**:
- 원문을 후리가나가 붙은 버전으로 대체한다.
- 번역 블록은 표시하지 않는다.

**호버 모드**:
- 텍스트에 점선 밑줄이 표시되어 호버 가능한 요소임을 알린다.
- 후리가나 ON이면 원문이 후리가나 버전으로 대체된다.
- 마우스를 올리면 팝업에 번역이 표시된다.

#### 장문 텍스트 (댓글, 영상 설명, 커뮤니티 게시글 등)

**인라인 모드**:
- 원문의 링크, @멘션, 타임스탬프 등 인터랙티브 요소를 보존한 채 후리가나를 추가한다.
- 문단 단위로 분할하여 각각 번역 블록을 삽입한다.
- URL만으로 이루어진 문단은 번역하지 않는다.

**후리가나 전용 모드**:
- 인터랙티브 요소를 보존한 채 후리가나만 추가한다.
- 번역 블록은 표시하지 않는다.

**호버 모드**:
- 인터랙티브 요소를 보존한 채 후리가나를 추가한다 (후리가나 ON일 때).
- 마우스를 올리면 전체 번역이 팝업으로 표시된다.

#### 짧은 라벨 (채널명, 해시태그, 사이드바 영상 제목 등)

**인라인 모드**:
- 원문 아래에 한 줄짜리 컴팩트 번역이 표시된다.
- 긴 번역은 말줄임표(...)로 잘린다.

**후리가나 전용 모드**:
- 원문 아래에 히라가나 읽기가 한 줄로 표시된다.

**호버 모드**:
- 점선 밑줄이 표시되며, 마우스를 올리면 팝업에 번역이 표시된다.

### 3.4 영상 설명 펼침

YouTube 시청 페이지의 영상 설명은 기본적으로 접혀 있다. "더보기"를 클릭하여 설명을 펼치면 ミク言葉가 이를 감지하고 번역을 시작한다.

### 3.5 스크롤 대응

YouTube는 댓글, 추천 영상 등을 스크롤 시 동적으로 로드한다. ミク言葉는 이를 감지하여:

- 새로 로드된 요소가 화면에 보이면 번역을 시작한다.
- 화면 밖의 요소는 번역하지 않아 불필요한 API 호출을 방지한다 (화면에 보이기 200px 전부터 미리 번역 시작).

### 3.6 SPA 네비게이션 대응

YouTube 내에서 페이지를 이동해도 (영상 클릭, 검색, 홈으로 이동 등) 확장 프로그램이 재시작 없이 동작한다.

- 이전 페이지의 번역 결과를 정리한다.
- 새 페이지의 요소를 감지하여 번역한다.
- YouTube가 비동기적으로 콘텐츠를 렌더링하므로, 페이지 이동 후 일정 시간에 걸쳐 점진적으로 요소를 탐색한다.
- 텍스트가 변경된 요소(이전 영상의 제목이 새 영상 제목으로 바뀐 경우 등)는 자동으로 감지하여 재번역한다.

### 3.7 다크/라이트 모드 대응

YouTube의 테마(다크 모드/라이트 모드)에 맞춰 번역 블록의 구분선, 텍스트 색상이 자동으로 조정된다.

---

## 4. 번역 제외/포함 판단

### 4.1 일본어 감지

페이지 텍스트는 히라가나/카타카나가 포함된 경우에만 번역 대상으로 인식된다. 한자만 있는 텍스트(중국어일 수 있음)는 일반적으로 번역하지 않는다.

### 4.2 중복 처리 방지

이미 번역된 요소는 다시 번역하지 않는다. 단, 텍스트 내용이 변경되면(예: SPA 네비게이션으로 제목이 바뀐 경우) 이전 번역을 제거하고 새로 번역한다.

---

## 5. 자막과 페이지 번역의 독립성

| 설정 | 자막 번역 | 페이지 텍스트 번역 |
|------|----------|-------------------|
| YouTube 자막 ON + 웹페이지 모드 ON | O | O |
| YouTube 자막 ON + 웹페이지 모드 OFF | O | X |
| YouTube 자막 OFF + 웹페이지 모드 ON | X | O |
| YouTube 자막 OFF + 웹페이지 모드 OFF | X | X |

두 기능은 완전히 독립적으로 제어된다.

---

## 6. 설정 변경 시 동작

### 6.1 실시간 반영

팝업이나 설정 페이지에서 설정을 변경하면 YouTube 탭에 즉시 반영된다.

- **자막 토글 ON/OFF**: 오버레이가 즉시 나타나거나 사라진다.
- **표시 옵션 변경** (후리가나/로마자/번역 토글): 자막 오버레이는 다음 자막부터, 페이지 번역은 핸들러가 재시작되어 모든 번역이 새 설정으로 다시 적용된다.
- **모드 변경** (호버 ↔ 인라인 ↔ 후리가나 전용): 기존 번역이 모두 제거되고, 새 모드로 다시 번역이 시작된다.
- **색상/크기 변경**: 자막 오버레이 스타일이 즉시 업데이트된다.

---

## 7. 제한사항

| 항목 | 설명 |
|------|------|
| 일본어 자막만 지원 | 다른 언어의 자막은 번역 대상이 아님 |
| 자막 없는 영상 | 일본어 자막(수동/자동)이 전혀 없는 영상에서는 자막 번역 불가 |
| 라이브 채팅 미지원 | 실시간 라이브 스트림의 채팅 메시지는 번역되지 않음 |
| 알림 미지원 | YouTube 알림 패널의 텍스트는 번역되지 않음 |
| YouTube Music 미지원 | `music.youtube.com`에서는 동작하지 않음 |
| 임베디드 플레이어 미지원 | 다른 사이트에 삽입된 YouTube 플레이어에서는 동작하지 않음 |
| 동시 번역 부하 | 댓글이 매우 많은 페이지에서 인라인 모드 사용 시 다수의 API 호출이 발생할 수 있음 |
| 자막 정확도 의존 | 자동 생성 자막(ASR)의 오류가 번역에 그대로 반영될 수 있음 |
| 자막 단어 클릭에서 단어장 추가 불가 | 오버레이에서 단어 상세를 볼 수는 있지만, 단어장에 바로 추가하는 기능은 없음 |

---

## 8. To-Do: 학습 효과 개선을 위한 추가 기능 제안

### 높은 우선순위

| 기능 | 설명 | 근거 |
|------|------|------|
| **자막→단어장 바로 추가** | 오버레이에서 단어 클릭 시 단어장에 추가하는 버튼. 예문에는 해당 자막 문장이 자동 입력 | 영상 시청 중 발견한 단어를 즉시 저장하여 학습 사이클 완성 |
| **자막 스크립트 뷰어** | 영상 전체 자막을 목록으로 보여주는 사이드 패널. 각 자막을 클릭하면 해당 시점으로 이동하고 번역도 표시 | 전체 맥락을 훑어보며 학습, 특정 표현을 찾기 쉬움 |
| **자막 번역 스포일러 모드** | 한국어 번역을 블러 처리하여 숨기고, 클릭/키보드로 열어보는 모드 (인라인 모드의 스포일러와 동일한 개념) | 먼저 일본어로 이해를 시도한 뒤 번역을 확인하는 능동적 학습 |
| **라이브 채팅 번역** | 실시간 라이브 스트리밍의 채팅 메시지 번역 (기본 OFF, 선택적 활성화) | 일본어 라이브 방송 시청 시 채팅 참여 지원 |

### 중간 우선순위

| 기능 | 설명 | 근거 |
|------|------|------|
| **자막 되감기 반복** | 현재 자막 구간을 반복 재생하는 단축키. 지정 횟수만큼 반복 후 다음 자막으로 진행 | 섀도잉(따라 말하기) 연습에 유용 |
| **자막 속도 조절 연동** | 자막 번역과 함께 재생 속도를 낮추는 "학습 모드". 어려운 문장에서 자동 감속 | 초보자가 빠른 대화를 따라가기 어려울 때 |
| **자막 난이도 표시** | 각 자막 문장의 JLPT 레벨을 추정하여 색상으로 표시 (N5=초록 ~ N1=빨강) | 학습자가 자기 수준에 맞는 영상인지 판단 가능 |
| **피드 사전 필터링** | 홈/검색 피드에서 일본어 영상만 하이라이트하거나, 번역된 제목으로 빠르게 훑어보기 | 일본어 학습용 영상 찾기 편의성 |
| **번역 비교 보기** | 자막에서 Papago와 AI 번역 결과를 나란히 비교 | 번역 뉘앙스 차이를 통한 언어 감각 향상 |
| **알림 번역** | YouTube 알림 패널의 일본어 알림 텍스트 번역 (기본 OFF) | 구독 채널의 알림 내용을 이해 |

### 낮은 우선순위

| 기능 | 설명 | 근거 |
|------|------|------|
| **자막 다운로드** | 번역된 자막을 SRT/VTT 파일로 내보내기 (원문+번역 이중 자막) | 오프라인 복습, 다른 플레이어에서 활용 |
| **YouTube Music 지원** | `music.youtube.com`에서 가사 번역 | 음악을 통한 일본어 학습 |
| **듀얼 자막 레이아웃 선택** | 원문과 번역을 좌우/상하로 배치하는 옵션 | 화면 공간 활용 선호에 따른 선택지 |
| **자막 히스토리** | 시청한 영상의 자막+번역을 자동 저장하여 나중에 복습 | 다시 보지 않아도 학습 내용 복습 가능 |
| **임베디드 플레이어 지원** | 다른 사이트에 삽입된 YouTube 플레이어에서도 자막 번역 | 블로그, 뉴스 등에 삽입된 일본어 영상 학습 |
| **Shorts 자막 번역** | Shorts의 세로형 플레이어에서 자막 번역 (현재는 페이지 텍스트만 지원) | Shorts 콘텐츠를 통한 짧은 일본어 학습 |
